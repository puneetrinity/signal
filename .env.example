# Database (Supabase PostgreSQL)
# Get your connection string from Supabase > Project Settings > Database > Connection Pooling
DATABASE_URL="postgresql://postgres.[PROJECT-REF]:[YOUR-PASSWORD]@aws-1-us-east-1.pooler.supabase.com:5432/postgres"

# Optional but recommended: direct (non-pooler) connection for migrations / introspection
DIRECT_URL="postgresql://postgres.[PROJECT-REF]:[YOUR-PASSWORD]@db.[PROJECT-REF].supabase.co:5432/postgres"

# Supabase (optional - for client-side requests)
# Get these from Supabase > Project Settings > API
NEXT_PUBLIC_SUPABASE_URL="https://[PROJECT-REF].supabase.co"
NEXT_PUBLIC_SUPABASE_ANON_KEY="your-anon-key-here"

# Bright Data API
# Get your API token from Bright Data > Settings > API Tokens
BRIGHTDATA_API_TOKEN="your-brightdata-api-token-here"

# Google AI (Gemini)
# Get your API key from Google AI Studio: https://makersuite.google.com/app/apikey
GOOGLE_GENERATIVE_AI_API_KEY="your-google-ai-api-key-here"

# Next.js
# Your application URL (use http://localhost:3000 for local development)
NEXT_PUBLIC_APP_URL="http://localhost:3000"

# Optional: Analytics
# PostHog API key (leave empty if not using analytics)
NEXT_PUBLIC_POSTHOG_KEY=""

# Redis (optional, for hot cache). Provide either:
# - REDIS_URL, or
# - REDIS_HOST + REDIS_PORT (+ optional REDIS_PASSWORD)
REDIS_URL="rediss://:your_password_here@redis-xxxxx.c123.us-east-1-1.ec2.cloud.redislabs.com:6379"
REDIS_TLS_ENABLED="true"

REDIS_HOST="redis-xxxxx.c123.us-east-1-1.ec2.cloud.redislabs.com"
REDIS_PORT="xxxxx"
REDIS_PASSWORD="your_password_here"

# Image proxy allowlist (optional). Comma-separated hosts and/or suffixes (prefix with a dot).
# Defaults to: .licdn.com
IMAGE_PROXY_ALLOWED_HOSTS=".licdn.com"

# ============================================
# v2 Provider Configuration (Feature Flags)
# ============================================

# Search Provider Selection
# Options: brightdata (default), searxng, brave
# Default is 'brightdata' for backward compatibility with v1
SEARCH_PROVIDER="brightdata"

# Optional: Fallback search provider when primary returns no results
# Set to enable SearXNG primary with Brave fallback:
#   SEARCH_PROVIDER="searxng"
#   SEARCH_FALLBACK_PROVIDER="brave"
SEARCH_FALLBACK_PROVIDER=""

# SearXNG Configuration (if SEARCH_PROVIDER=searxng)
# Self-hosted metasearch instance URL
SEARXNG_URL="https://searxng-railway-production-9236.up.railway.app"
SEARXNG_TIMEOUT="10000"

# Brave Search API (if SEARCH_PROVIDER=brave or SEARCH_FALLBACK_PROVIDER=brave)
# Get your API key from: https://brave.com/search/api/
# Pricing: Free (2K/month), Base ($5/1000), Pro ($9/1000)
BRAVE_API_KEY=""
BRAVE_TIMEOUT="8000"

# Parser Provider Selection
# Options: gemini (default), groq
# Default is 'gemini' for backward compatibility
PARSER_PROVIDER="gemini"

# Groq Configuration (if PARSER_PROVIDER=groq)
# Get your API key from: https://console.groq.com/
# NOTE: Requires npm install @ai-sdk/groq
GROQ_API_KEY=""
# Optional: Override default model (default: meta-llama/llama-4-scout-17b-16e-instruct)
# Must support structured outputs: https://console.groq.com/docs/structured-outputs#supported-models
# Options: meta-llama/llama-4-scout-17b-16e-instruct, meta-llama/llama-4-maverick-17b-128e-instruct, openai/gpt-oss-20b
GROQ_MODEL=""

# v2 Feature Flags
# Enable new discovery mode (leads/candidates instead of profiles)
USE_NEW_DISCOVERY="false"

# ============================================
# v1 Deprecation / Compliance Flags
# ============================================

# Disable v1 endpoints that scrape or return full LinkedIn profile data.
# Recommended: set to "true" in production once you migrate to v2.
# Notes:
# - When USE_NEW_DISCOVERY="true", v1 scraping endpoints should be treated as deprecated anyway.
DISABLE_V1_SCRAPING="false"

# ============================================
# v2 Enrichment Configuration
# ============================================

# GitHub API Token (for identity discovery)
# Get a Personal Access Token from: https://github.com/settings/tokens
# Recommended scopes: public_repo (or just use no scopes for read-only public access)
# Rate limits: 60 req/hr unauthenticated, 5000 req/hr with token
GITHUB_TOKEN=""

# Enrichment Search Provider Configuration
# Separate from main search to allow different strategies
# Enrichment order: GitHub API → Brave (primary) → SearXNG (fallback)
#
# Options: brave (recommended), searxng, brightdata
# Default is 'brave' for compliance + predictability
ENRICHMENT_SEARCH_PROVIDER="brave"

# Fallback provider when primary returns too few results or fails
# Default is 'searxng' for best-effort recall boost
ENRICHMENT_SEARCH_FALLBACK_PROVIDER="searxng"

# Minimum results from primary before trying fallback
# If primary returns fewer results, fallback will be tried
MIN_RESULTS_BEFORE_FALLBACK="2"

# ============================================
# v2 LangGraph Async Enrichment (Optional)
# ============================================

# Enable LangGraph-based async enrichment
# When true: POST /api/v2/enrich/async creates a job and returns immediately
# When false: Enrichment runs synchronously (default)
USE_LANGGRAPH_ENRICHMENT="false"

# Enable Postgres checkpointer for graph state persistence and resumability
# Requires DIRECT_URL or DATABASE_URL to be set
# When true: Graph state is checkpointed to Postgres, allowing job resumption
# When false: Graph runs without checkpointing (default)
USE_LANGGRAPH_CHECKPOINTER="false"

# Worker concurrency (number of parallel jobs)
# Only relevant when running the worker: npm run worker:enrichment
ENRICHMENT_WORKER_CONCURRENCY="3"

# Redis URL for BullMQ job queue (required if USE_LANGGRAPH_ENRICHMENT=true)
# Reuses REDIS_URL if set, otherwise defaults to localhost
# REDIS_URL is already defined above - BullMQ will use it

# ============================================
# v2 Authentication (REQUIRED for production)
# ============================================

# API Keys for machine-to-machine auth (comma-separated)
# Generate secure random keys for production
# Example: openssl rand -hex 32
API_KEYS=""

# Auth enforcement (defaults based on NODE_ENV)
# In production: auth enforced unless DISABLE_AUTH=true
# In development: auth not enforced unless ENFORCE_AUTH=true
ENFORCE_AUTH="false"
# DISABLE_AUTH="false"  # Only set in production to temporarily disable auth
